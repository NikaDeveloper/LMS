# Learning Management System (LMS) API
#### Проект представляет собой бэкенд для системы управления обучением (LMS), реализованный на Django Rest Framework.Система включает управление курсами, уроками, платежами,а также сложную систему прав доступа на основе JWT-авторизации и ролей пользователей.

### *Стек технологий:*
* **Язык:** Python 3.10+
* **Фреймворк:** Django 5.x
* **API:** Django REST Framework (DRF)
* **База данных:** PostgreSQL
* **Авторизация:** JWT (`djangorestframework-simplejwt`)
* **Платежная система:** Stripe
* **Документация API:** drf-yasg (Swagger/ReDoc)
* **Асинхронность:** Celery, Celery Beat
* **Брокер сообщений/Кэш:** Redis
* **Управление зависимостями:** pip-tools
* **Тестирование:** Unittest, APITestCase
* **Дополнительно:** django-filter, Pillow

### Ключевой функционал
#### *Авторизация и Пользователи:*

* Регистрация и вход по email.
* JWT-токены (Access/Refresh).
* **Приватность:** Скрытие фамилии и истории платежей при просмотре чужого профиля.

### Курсы и Уроки
* Полный CRUD для уроков и курсов.
* **Валидация:** Запрет на использование ссылок на сторонние ресурсы (разрешен только `youtube.com`).
* **Пагинация:** Постраничный вывод списка материалов.
* **Подписки:** Механизм подписки на обновления курса.

### Права доступа (Permissions)
* **Владелец:** Редактирует и удаляет только свои объекты.
* **Модератор:** Редактирует любые объекты, но не может удалять их или создавать новые.
* **Публичный доступ:** Закрыт (требуется авторизация).

### Платежи (Stripe)
* Интеграция со Stripe (создание продукта, цены и сессии оплаты).
* Получение ссылки на оплату.
* Проверка статуса платежа через API.
* Фильтрация истории платежей по дате и способу оплаты.

### Асинхронные операции (Celery):

* **Уведомления:** Автоматическая асинхронная рассылка писем всем подписчикам при обновлении курса.

* **Обслуживание пользователей:** Ежедневная блокировка пользователей, неактивных более 30 дней (с помощью Celery Beat)
---

## Установка и запуск проекта:
1. Клонирование репозитория
```Bash
git clone https://github.com/NikaDeveloper/LMS.git
cd LMS 
```
2. Создание и активация виртуального окружения
```Bash
# Windows
python -m venv .venv
.venv\Scripts\activate

# Linux/macOS
python3 -m venv .venv
source .venv/bin/activate
```
3. Установка зависимостей

*Проект использует pip-tools для фиксации версий.*

```Bash
pip install -r requirements.txt
```
*(Для разработчиков, желающих установить dev-зависимости):*
```Bash
pip install -r dev-requirements.txt
```
4. Настройка окружения (.env)

*Создайте файл .env в корне проекта и заполните его по образцу .env.example*

5. Применение миграций
```Bash
python manage.py makemigrations
python manage.py migrate
```
6. Настройка прав (Важно!)

Для корректной работы прав доступа необходимо создать группу модераторов. Вы можете сделать это через админ-панель:
```Bash
python manage.py createsuperuser
# Далее зайдите в админку [http://127.0.0.1:8000/admin/]
# Перейдите в "Groups" -> "Add group" -> Назовите её "Moderators".
```
7. Запуск сервера
```Bash
python manage.py runserver
```
#### *Проект будет доступен по адресу:* http://127.0.0.1:8000/

8. Убедитесь, что Redis запущен

8.1. Запуск Celery Worker (обработчик задач)
```Bash
celery -A config worker -l info -P eventlet #windows
```
8.2. Запуск Celery Beat (планировщик периодических задач)
```Bash
celery -A config beat -l info
```

### Документация API

*После запуска сервера документация доступна по адресам:*

* Swagger UI: https://www.google.com/search?q=http://127.0.0.1:8000/swagger/
* ReDoc: https://www.google.com/search?q=http://127.0.0.1:8000/redoc/

*Разработчик: Nika Developer*
